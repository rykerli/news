#!/usr/bin/env python
# -*- encoding: utf-8 -*-
"""
@Time    : 2019-01-11 13:05
@Author  : red
@Site    : 
@File    : docx_util.py
@Software: PyCharm
"""
import os
import shutil

from utils import file_util
from docx import Document
from docx.oxml.ns import qn
from docx.enum.text import WD_PARAGRAPH_ALIGNMENT
from docx.shared import Pt, RGBColor

global doc
global last_err
last_err = ""


def save(dst):
	global doc
	global last_err
	try:
		doc.save(dst)
		return True
	except IOError as e:
		last_err = e.strerror
		return False


def path_exists(path):
	if not os.path.exists(path):
		os.mkdir(path)
	else:
		shutil.rmtree(path)
		os.mkdir(path)


def add_info_title(title):
	global doc
	head = doc.add_heading("", level=3)
	run = head.add_run(title)
	run.font.size = Pt(12)
	run.font.color.rgb = RGBColor(0, 0, 0)
	run.font.name = u"å®‹ä½“"
	run._element.rPr.rFonts.set(qn('w:eastAsia'), u'å®‹ä½“')


def add_text(text):
	global doc
	p = doc.add_paragraph()
	run = p.add_run(text)
	run.font.size = Pt(8)
	run.font.name = u"å®‹ä½“"
	run._element.rPr.rFonts.set(qn('w:eastAsia'), u'å®‹ä½“')


def add_text_list(text_list):
	for text in text_list:
		global doc
		p = doc.add_paragraph()
		run = p.add_run(text)
		run.font.size = Pt(8)
		run.font.name = u"å®‹ä½“"
		run._element.rPr.rFonts.set(qn('w:eastAsia'), u'å®‹ä½“')


def init(title):
	global doc
	doc = Document()
	doc.styles["Normal"].font.name = u'å®‹ä½“'
	doc.styles["Normal"].font.size = Pt(8)
	doc.styles["Normal"]._element.rPr.rFonts.set(qn('w:eastAsia'), u'å®‹ä½“')
	head = doc.add_heading("", level=1)
	run = head.add_run(title)
	run.font.size = Pt(20)
	run.font.color.rgb = RGBColor(128, 0, 0)
	run.font.name = u"å®‹ä½“"
	run._element.rPr.rFonts.set(qn('w:eastAsia'), u'å®‹ä½“')
	# head.alignment = WD_ALIGN_PARAGRAPH.CENTER
	head.alignment = WD_PARAGRAPH_ALIGNMENT.CENTER


def save_docx(array, path):
	init(array[0])
	add_info_title(u"æ ‡é¢˜")
	add_text(array[0])
	add_info_title(u"é‡‡é›†æ—¶é—´")
	add_text(array[1])
	add_info_title(u"æ­£æ–‡")
	add_text(array[2])
	add_info_title(u"é˜…è¯»æ•°")
	add_text(array[3])
	add_info_title(u"è¯„è®º")
	add_text_list(array[4])

	save(path)


def save_sina_docx(array, path):
	init(array[0])
	add_info_title(u"ç”¨æˆ·æ˜µç§°")
	add_text(array[1])

	add_info_title(u"å‘å¸ƒæ—¶é—´")
	add_text(str(array[2]))

	add_info_title(u"å¾®åšå†…å®¹")
	add_text(array[3])

	add_info_title(u"è½¬å‘æ•°")
	add_text(str(array[4]))

	add_info_title(u"è¯„è®ºæ•°")
	add_text(str(array[5]))

	add_info_title(u"ç‚¹èµæ•°")
	add_text(str(array[6]))

	add_info_title(u"è¯„è®º")
	add_text_list(array[7])

	save(path)


def save_content_to_docx(file_path, content):
	file = Document()
	file.add_paragraph(content)
	file.save(file_path)


if __name__ == '__main__':
	# array = ['é…’åº—æ¨é›†èµåƒå…è´¹å¤§é¤ååæ‚”ï¼Œé‡ä¸Šæ•°ç™¾ä½æ”¿æ³•å¤§å­¦ç”Ÿï¼Œç»“æœâ€¦â€¦', '2018-11-18 21:20',
	# 		 'åŸæ ‡é¢˜ï¼šé…’åº—æ¨é›†èµåƒå…è´¹å¤§é¤ååæ‚”ï¼Œé‡ä¸Šæ•°ç™¾ä½æ”¿æ³•å¤§å­¦ç”Ÿï¼Œç»“æœâ€¦â€¦\n            è¿‘æ—¥ï¼Œæ­¦æ±‰ä¸€é…’åº—é€šè¿‡å®˜æ–¹å¾®ä¿¡å‘å‡ºä¸€ç¯‡æ´»åŠ¨æ¨æ–‡ï¼Œç§°ç½‘å‹åªè¦é›†é½80ä¸ªç‚¹èµå°±å¯ä»¥å…è´¹é¢†å–ä¸€å¼ ä»·å€¼168å…ƒçš„è‡ªåŠ©é¤åˆ¸ã€‚ \n11æœˆ15æ—¥ï¼Œçº¦400ä½å­¦ç”Ÿå‰æ¥å…‘æ¢æ—¶ï¼Œé…’åº—å´ä¸äºˆå…‘æ¢ã€‚ç°åœºå¾ˆå¤šéƒ½æ˜¯ä¸­å—è´¢ç»æ”¿æ³•å¤§å­¦æ³•å­¦é™¢çš„å­¦ç”Ÿï¼Œç§¯æç»´æƒã€‚ç»è­¦æ–¹å’Œæ¶ˆåè°ƒè§£ï¼Œé…’åº—ç­”åº”æŒ‰æ‰¿è¯ºç»™åˆ¸ã€‚ \né…’åº—æ‰¿è¯ºâ€œé›†èµå…è´¹é€é¤åˆ¸â€å´å˜å¦ \nè¿‘æ—¥ï¼Œæœ‰ç½‘å‹åœ¨å¾®åšçˆ†æ–™ç§°ï¼Œä¸­å—è´¢ç»æ”¿æ³•å¤§å­¦æ—ä¸€é…’åº—å‘å¸ƒé›†èµé€å…è´¹è‡ªåŠ©é¤çš„æ´»åŠ¨ï¼Œå•†å®¶åœ¨å‘å¸ƒè¯¥å†…å®¹çš„æ–‡ç« ä¸‹ï¼Œå›å¤â€œæ²¡æœ‰åé¢é™åˆ¶â€ã€‚ \n \nå½“å¤©ï¼Œè®¸å¤šåŒå­¦åœ¨æœ‹å‹åœˆè½¬å‘è¯¥æ–‡ç« æ±‚èµã€‚ç„¶è€Œï¼Œè¯¥å•†å®¶çªç„¶é€šçŸ¥â€œåé¢å·²æ»¡â€ã€‚éšåï¼Œè®¸å¤šå­¦ç”Ÿå‰å¾€é…’åº—ç»´æƒã€‚ \n \næ•°ç™¾æ”¿æ³•å­¦å­ç°åœºç»´æƒ \n15æ—¥ä¸‹åˆ1æ—¶è®¸ï¼Œè®°è€…åœ¨æ­¦æ±‰æ°‘æ—å¤§é“é‡‘è°·å›½é™…é…’åº—å†…çœ‹åˆ°ï¼Œè¿‘ç™¾åå¤§å­¦ç”Ÿæ­£æ’æˆä¸¤é˜Ÿï¼Œç­‰å¾…é¢†å–è‡ªåŠ©é¤åˆ¸ã€‚ä¸€åå­¦ç”Ÿè¡¨ç¤ºï¼Œç°åœ¨é…’åº—æ²¡æœ‰å·¥ä½œäººå‘˜å‘åˆ¸ï¼Œä»–ä»¬ä¸çŸ¥é“èƒ½å¦é¢†åˆ°é¤åˆ¸ã€‚ \n \nä¸€åç‹å§“åŒå­¦è¯´ï¼Œ14æ—¥å¥¹é€šè¿‡åŒå­¦å¾—çŸ¥é‡‘è°·å›½é™…é…’åº—çš„å®˜æ–¹å¾®ä¿¡å‘å‡ºä¸€ç¯‡æ´»åŠ¨æ¨å¹¿æ–‡ç« ï¼Œæ–‡ç« ç§°åªè¦é›†é½80ä¸ªç‚¹èµå°±å¯ä»¥å…è´¹é¢†å–é…’åº—ä»·å€¼168å…ƒçš„è¥¿é¤è‡ªåŠ©æ™šé¤åˆ¸ä¸€å¼ ï¼Œä¸”æ²¡æœ‰åé¢é™åˆ¶ï¼Œæ—¶é—´æˆªæ­¢åˆ°11æœˆ16æ—¥ä¸­åˆ12æ—¶ã€‚å½“æ—¥ä¸Šåˆå¥¹å’Œå¾ˆå¤šåŒå­¦é›†é½80ä¸ªç‚¹èµååˆ°é‡‘è°·å›½é™…é…’åº—æ¥é¢†å–è‡ªåŠ©é¤åˆ¸æ—¶è¢«å‘ŠçŸ¥ï¼Œè¯¥æ´»åŠ¨æ˜¯é’ˆå¯¹æ›¾åœ¨é…’åº—æ¶ˆè´¹è¿‡çš„å®¢äººï¼Œä¸é’ˆå¯¹å­¦ç”Ÿã€‚ \n \nè¿˜æœ‰äººç§°ï¼ŒæœåŠ¡å‘˜ç°åœºæœ‰æƒæ— æâ€œæœ‰æœ¬äº‹ä½ ä¸¾æŠ¥æˆ‘å•Šï¼Œä½ ä»¬åˆæ²¡æ¶ˆè´¹ã€‚â€ \n \né…’åº—çš„è¯´æ³•å¼•å‘ç°åœºå­¦å­çš„æ„¤æ€’ï¼Œå¤§ä¼™å›´ä½é…’åº—å·¥ä½œäººå‘˜æ¬²è®¨ä¸ªè¯´æ³•ã€‚å­¦ç”ŸæŠ¥è­¦åï¼Œè­¦å¯Ÿå”å”ä¹ŸåŠæ—¶èµ¶åˆ°ï¼Œå¹¶ç»„ç»‡å­¦ç”Ÿæœ‰ç§©åºåœ°ç™»è®°ç›¸å…³æƒ…å†µã€‚ \nåœ¨è­¦æ–¹å’Œæ¶ˆåéƒ¨é—¨çš„åè°ƒä¸‹ï¼Œé…’åº—æ–¹æœ€ç»ˆå‘æ‰€æœ‰é›†é½80ä¸ªç‚¹èµçš„ä¸€åƒå¤šåå­¦ç”Ÿå‘æ”¾äº†è‡ªåŠ©é¤åˆ¸ã€‚ \n \nè§†é¢‘æ›å…‰ï¼Œç»´æƒè¢«ç½‘å‹æ€’èµ \nè¿™æ¬¡äº‹ä»¶æœ¬å°±è¿™æ ·è¿‡å»äº†ï¼Œä½†æ˜¯å½“ç½‘ä¸Šæ›å‡ºæ”¿æ³•å­¦å­ç°åœºç»´æƒè§†é¢‘æ—¶ï¼Œåˆå¼•å‘äº†æ–°ä¸€æ³¢çš„å…³æ³¨ã€‚ \næœ‰ç½‘å‹è¯„ä»·è¯¥è§†é¢‘ï¼šâ€œå†…å®¹å¼•èµ·å¼ºçƒˆèˆ’é€‚ã€‚â€ \nå¯¹äºä¸ºä»€ä¹ˆè¦ç»´æƒï¼Œä¸­å—è´¢ç»æ”¿æ³•å¤§å­¦çš„å­¦ç”Ÿæ˜¯è¿™æ ·è¯´çš„ï¼š \nâ€œé‡‘è°·é…’åº—åœ¨å¾®ä¿¡å…¬ä¼—å·é‡Œå‘èµ·æ´»åŠ¨ï¼Œè¯´é›†æ»¡80ä¸ªèµï¼Œå°±å¯ä»¥å…è´¹è·å¾—168å…ƒçš„è‡ªåŠ©é¤åˆ¸ä¸€å¼ ã€‚ç„¶åæˆ‘ä»¬å­¦æ ¡çš„å¾ˆå¤šå­¦ç”Ÿéƒ½é›†èµäº†ã€‚ä»–ä»¬ä»Šå¤©æ—©ä¸Šçš„æ—¶å€™çªç„¶ä¸€ä¸‹å­ä¸æ‰¿è®¤è¿™ä¸ªæ´»åŠ¨äº†ï¼Œè¯´åé¢å·²ç»æ»¡äº†ã€‚æˆ‘ä»¬åœ¨é‚£ä¸ªæ¨æ–‡ä¸‹é¢ï¼Œå·²ç»æ˜ç¡®åœ°é—®è¿‡ä»–ä»¬ï¼Œæ˜¯å¦æœ‰åé¢é™åˆ¶è¿™ä¸€æ¡ï¼Œä»–ä»¬å›å¤äº†ä¸¤æ¬¡ï¼Œæ˜¯æ²¡æœ‰åé¢é™åˆ¶çš„ã€‚ä»–ä»¬é‚£è¾¹ç›¸å½“äºç»™æˆ‘ä»¬å‘å‡ºäº†ä¸€ä¸ªè¦çº¦ï¼Œè€Œæˆ‘ä»¬è¿™è¾¹ä¹Ÿæ‰¿è¯ºäº†ï¼Œé‚£æˆ‘ä»¬è¿™è¾¹æŒ‰ç…§åˆåŒæ³•ï¼Œæˆ‘ä»¬å°±åº”è¯¥æœ‰è¿™æ ·ä¸€ä»½168çš„æ™šé¤ã€‚â€ \næ˜¯ä¸æ˜¯æœ‰ç†æœ‰åˆ©æœ‰èŠ‚ï¼Œè®©äººå¿ƒæœå£æœï¼Ÿ \nå½“å¤©ï¼Œè¯¥è§†é¢‘è¿˜ç™»ä¸Šå¾®åšã€çŸ¥ä¹ç­‰å¹³å°çƒ­æœï¼Œ@äººæ°‘æ—¥æŠ¥ 19æ—¶å‘å¸ƒäº†ç›¸å…³å†…å®¹çš„å¾®åšï¼šå­¦ä»¥è‡´ç”¨ï¼é…’åº—ä¸¾åŠâ€œé›†èµå…è´¹åƒâ€åˆåæ‚”ï¼Œ400åæ”¿æ³•å¤§å­¦ç”Ÿç»´æƒ]15æ—¥ï¼Œ@ä¸­å—è´¢ç»æ”¿æ³•å¤§å­¦ æ—ä¸€é…’åº—å‘å¸ƒé›†èµæ¢ä»£é‡‘åˆ¸å…è´¹åƒå¤§é¤æ´»åŠ¨ï¼Œçº¦400ä½å­¦ç”Ÿå‰æ¥å…‘æ¢æ—¶ï¼Œé…’åº—å´ä¸äºˆå…‘æ¢ã€‚ç°åœºå¾ˆå¤šéƒ½æ˜¯ä¸­å—è´¢å¤§æ³•å­¦é™¢çš„å­¦ç”Ÿï¼Œç§¯æç»´æƒã€‚ç»è­¦æ–¹å’Œæ¶ˆåè°ƒè§£ï¼Œé…’åº—ç­”åº”æŒ‰æ‰¿è¯ºç»™åˆ¸ã€‚ \n \n@ä¸­å—è´¢ç»æ”¿æ³•å¤§å­¦ è¿˜è½¬å‘äººæ°‘æ—¥æŠ¥å¾®åšç§°ï¼šâ€œå°±åœ°è¯æ³•â€ã€‚ \n \nç½‘å‹è¯„è®º \n \näºç»´æƒï¼Œç½‘å‹ä¹Ÿæå‡ºäº†éå¸¸æ­£ç¡®çš„è§‚ç‚¹ï¼šç»´æƒè¿‡ç¨‹ä¸­è¦ä¿æŒè‰¯å¥½çš„ç§©åºï¼Œåªç”¨äº‹å®å’Œæ³•å¾‹è®²è¯ã€‚åŒæ—¶ï¼Œä¸å½±å“é…’åº—çš„å…¶ä»–å®¢äººï¼Œä¸å½±å“è­¦å¯Ÿæ‰§æ³•ï¼Œä¾æ³•ç»´æƒã€‚ \næ¥æºï¼šæ¥šå¤©éƒ½å¸‚æŠ¥ã€æ¾æ¹ƒæ–°é—»è¿”å›æœç‹ï¼ŒæŸ¥çœ‹æ›´å¤š      è´£ä»»ç¼–è¾‘ï¼š',
	# 		 None, ['èƒ¡è˜¿è””ç´ éå¤šç—‡(åŒ—äº¬å¸‚åŒ—äº¬å¸‚)', 'æ— è‰¯å•†å®¶ç©å¥—è·¯ï¼Œæ”¿æ³•å­¦å­è®²è¯æ®ğŸ˜„ğŸ˜„ğŸ˜„ğŸ˜„', None, None]]
	# save_docx(array, os.path.join("/Users/red/Desktop", array[0] + ".docx"))
	save_content_to_docx("/Users/red/Desktop/temp/news/data/sj_data/all_data/article.docx",
						 file_util.read_file('/Users/red/Desktop/temp/news/data/sj_data/all_data/article_txt.txt'))
